<div class="dashboard">
  <!-- Welcome Section -->
  <div class="welcome-section">
    <div class="welcome-content">
      <h1>Bienvenue, {{ currentUser?.prenom }} ! üëã</h1>
      <p>Voici un aper√ßu de vos missions et activit√©s r√©centes</p>
    </div>
    <button class="btn btn-primary" *ngIf="canCreateMission()" (click)="navigateToRoute(getCreateMissionRoute())">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
      Nouvelle Mission
    </button>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <!-- Missions Totales -->
    <div class="stat-card">
      <div class="stat-icon missions">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.totalMissions }}</div>
        <div class="stat-label">Missions Totales</div>
      </div>
    </div>

    <!-- En cours -->
    <div class="stat-card">
      <div class="stat-icon progress">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.enCours }}</div>
        <div class="stat-label">En Cours</div>
      </div>
    </div>

    <!-- En attente de validation -->
    <div class="stat-card" *ngIf="canValidate()">
      <div class="stat-icon pending">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.enAttenteValidation }}</div>
        <div class="stat-label">√Ä Valider</div>
      </div>
    </div>

    <!-- Budget utilis√© -->
    <div class="stat-card">
      <div class="stat-icon budget">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <line x1="12" y1="1" x2="12" y2="23"></line>
          <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.budgetUtilise | number:'1.0-0' }} FCFA</div>
        <div class="stat-label">Budget Utilis√©</div>
      </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="dashboard-grid">
    <!-- Missions R√©centes -->
    <div class="dashboard-card">
      <div class="card-header">
        <h2>Missions R√©centes</h2>
        <a routerLink="/missions" class="link">Voir tout</a>
      </div>
      <div class="card-body">
        <div class="mission-list" *ngIf="recentMissions.length > 0; else noMissions">
          <div class="mission-item" *ngFor="let mission of recentMissions" 
               [routerLink]="['/missions', mission.id]">
            <div class="mission-info">
              <div class="mission-title">{{ mission.titre }}</div>
              <div class="mission-meta">
                <span class="mission-date">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                  </svg>
                  {{ mission.dateDebut | date:'dd/MM/yyyy' }}
                </span>
                <span class="mission-location">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                  </svg>
                  {{ mission.lieuMission }}
                </span>
              </div>
            </div>
            <span class="status-badge" [attr.data-status]="mission.statut">
              {{ getStatutLabel(mission.statut) }}
            </span>
          </div>
        </div>
        <ng-template #noMissions>
          <div class="empty-state">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
            </svg>
            <p>Aucune mission r√©cente</p>
          </div>
        </ng-template>
      </div>
    </div>

    <!-- Validations en attente (pour validateurs) -->
    <div class="dashboard-card" *ngIf="canValidate()">
      <div class="card-header">
        <h2>Validations en Attente</h2>
        <a routerLink="/validations" class="link">Voir tout</a>
      </div>
      <div class="card-body">
        <div class="validation-list" *ngIf="pendingValidations.length > 0; else noValidations">
          <div class="validation-item" *ngFor="let validation of pendingValidations"
               [routerLink]="['/validations', validation.id]">
            <div class="validation-info">
              <div class="validation-title">{{ validation.mission.titre }}</div>
              <div class="validation-meta">
                <span class="validation-user">Par: {{ validation.mission.createur.prenom }} {{ validation.mission.createur.nom }}</span>
                <span class="validation-level" [class.urgent]="validation.enRetard">
                  {{ getNiveauLabel(validation.niveau) }}
                </span>
              </div>
            </div>
            <div class="validation-actions">
              <button class="btn-icon success" (click)="validateMission($event, validation.id, 'VALIDEE')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
              </button>
              <button class="btn-icon danger" (click)="validateMission($event, validation.id, 'REJETEE')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <ng-template #noValidations>
          <div class="empty-state">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <polyline points="9 11 12 14 22 4"></polyline>
              <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
            </svg>
            <p>Aucune validation en attente</p>
          </div>
        </ng-template>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <h2>Actions Rapides</h2>
    <div class="actions-grid">
      <button class="action-card" *ngIf="canCreateMission()" (click)="navigateToRoute(getCreateMissionRoute())">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        <span>Cr√©er une Mission</span>
      </button>

      <button class="action-card" routerLink="/missions">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
        </svg>
        <span>Mes Missions</span>
      </button>

      <button class="action-card" routerLink="/justificatifs" *ngIf="stats.justificatifsEnAttente > 0">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
          <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
        <span>D√©poser Justificatifs</span>
        <span class="badge">{{ stats.justificatifsEnAttente }}</span>
      </button>

      <button class="action-card" routerLink="/profil">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        <span>Mon Profil</span>
      </button>
    </div>
  </div>
</div> 